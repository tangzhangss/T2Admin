var curJsonObj,lockState="",curType="",curSkin="",jsonStr={table:{clild:{thead:{clild:{tr:{self:{style:{}}}}},tbody:{clild:{tr:{self:{style:{},pseudoClass:{hover:{},odd:{},even:{}}}}}},tfoot:{clild:{tr:{self:{style:{}}}}}}}};function init(){$.ajax({url:"../../rdp/customSkinList",cache:!1,type:"post",success:function(l){$.each(l.list,function(l,e){$("#skinCustomTree").append('<option value="'+e+'">'+e+"</option>")})}}),$("#skinCustomTree").on("change",function(){var e=$(this).val();""!=e?$.ajax({url:"../../rdp/getCustomSkin?fileName="+e,cache:!1,type:"post",success:function(l){curJsonObj=l.json,curSkin=e,$("ul.current li").removeClass("cur"),curType="",initValue(),preview()}}):(curJsonObj=null,$("ul.current li").removeClass("cur"),curSkin=curType="",initValue(),preview())}),$("ul.current li").on("click",function(){""!=$("#skinCustomTree").val()?($("ul.current li").removeClass("cur"),$(this).addClass("cur"),curType=$(this).attr("cate"),setValue()):layer.msg("请选择要操作的皮肤！")}),$("#cur_border").on("change",function(){getValue()}),$("#cur_fontsize").on("change",function(){getValue()}),$("#cur_padding").on("change",function(){getValue()}),$("#cur_fontweight").on("change",function(){getValue()}),$("#cur_verticalalign").on("change",function(){getValue()}),$("#cur_textalign").on("change",function(){getValue()}),$("#cur_backgroundcolor").on("change",function(){getValue()}),$("#cur_color").on("change",function(){getValue()})}function checkAddNode(){""==lockState?layer.prompt({value:"",formType:0,maxlength:10,title:"请输入皮肤名称"},function(e,t,l){var r;null!=e&&2<e.length&&/^[\w]+$/.test(e)?(r=!0,$("#skinCustomTree").each(function(){$(this).val()==e&&(r=!1)}),r?$.ajax({url:"../../rdp/checkSkin",data:{fileName:e},type:"post",success:function(l){"0"==l.code?(addNode(e),layer.close(t)):layer.msg(l.msg)}}):layer.msg("皮肤已经存在了！")):layer.msg("皮肤名称只能为长度大于2的英文、数字或下划线！")}):layer.alert("请先保存当前编辑的皮肤！")}function addNode(l){$("#skinCustomTree").append('<option value="'+l+'">'+l+"</option>"),$("#skinCustomTree").val(l),curSkin=l,curJsonObj=jsonStr,lockState="add",$("ul.current li").removeClass("cur"),curType="",$("#skincss").empty("")}function removeNode(){""!=$("#skinCustomTree").val()?layer.confirm("确认删除皮肤  “"+$("#skinCustomTree").val()+"” 吗？",{btn:["确定","取消"]},function(l){"edit"==lockState||""==lockState?$.ajax({url:"../../rdp/removeCustomSkin?fileName="+$("#skinCustomTree").val(),cache:!1,type:"post",success:function(l){$("#skinCustomTree option[value='"+$("#skinCustomTree").val()+"']").remove(),layer.msg("删除成功！")}}):($("#skinCustomTree option[value='"+$("#skinCustomTree").val()+"']").remove(),layer.msg("删除成功！"))},function(l){layer.close(l)}):layer.msg("请选择要删除的皮肤！")}function initValue(){$("#cur_border").val(""),$("#cur_fontsize").val(""),$("#cur_padding").val(""),$("#cur_fontweight").val(""),$("#cur_verticalalign").val(""),$("#cur_textalign").val(""),$("#cur_backgroundcolor").val("FFFFFF"),$("#cur_color").val("000000")}function setValue(){if(initValue(),""!=curType&&null!=curJsonObj){var l="";switch(curType){case"thead":l=curJsonObj.table.clild.thead.clild.tr.self.style;break;case"tbody":l=curJsonObj.table.clild.tbody.clild.tr.self.style;break;case"tbody-hover":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.hover;break;case"tbody-odd":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.odd;break;case"tbody-even":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.even;break;case"tfoot":l=curJsonObj.table.clild.tfoot.clild.tr.self.style}$("#cur_border").val(null!=l.border?l.border:""),$("#cur_fontsize").val(null!=l["font-size"]?l["font-size"]:""),$("#cur_padding").val(null!=l.padding?l.padding:""),$("#cur_fontweight").val(null!=l["font-weight"]?l["font-weight"]:""),$("#cur_verticalalign").val(null!=l["vertical-align"]?l["vertical-align"]:""),$("#cur_textalign").val(null!=l["text-align"]?l["text-align"]:""),$("#cur_backgroundcolor").val(null!=l["background-color"]?l["background-color"].replace("#",""):"FFFFFF").focus().blur(),$("#cur_color").val(null!=l.color?l.color.replace("#",""):"000000").focus().blur()}}function getValue(){if(""!=curType&&null!=curJsonObj){var l="";switch(curType){case"thead":l=curJsonObj.table.clild.thead.clild.tr.self.style;break;case"tbody":l=curJsonObj.table.clild.tbody.clild.tr.self.style;break;case"tbody-hover":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.hover;break;case"tbody-odd":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.odd;break;case"tbody-even":l=curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.even;break;case"tfoot":l=curJsonObj.table.clild.tfoot.clild.tr.self.style}null==$("#cur_border").val()||""==$("#cur_border").val()?delete l.border:l.border=$("#cur_border").val(),null==$("#cur_fontsize").val()||""==$("#cur_fontsize").val()?delete l["font-size"]:l["font-size"]=$("#cur_fontsize").val(),null==$("#cur_padding").val()||""==$("#cur_padding").val()?delete l.padding:l.padding=$("#cur_padding").val(),null==$("#cur_fontweight").val()||""==$("#cur_fontweight").val()?delete l["font-weight"]:l["font-weight"]=$("#cur_fontweight").val(),null==$("#cur_verticalalign").val()||""==$("#cur_verticalalign").val()?delete l["vertical-align"]:l["vertical-align"]=$("#cur_verticalalign").val(),null==$("#cur_textalign").val()||""==$("#cur_textalign").val()?delete l["text-align"]:l["text-align"]=$("#cur_textalign").val(),null==$("#cur_backgroundcolor").val()||"FFFFFF"==$("#cur_backgroundcolor").val()?delete l["background-color"]:l["background-color"]="#"+$("#cur_backgroundcolor").val(),null==$("#cur_color").val()||"000000"==$("#cur_color").val()?delete l.color:l.color="#"+$("#cur_color").val(),preview()}}function preview(){var l=".skinPreview ",e="";null!=curJsonObj&&(e+=l+" thead tr td"+JSON.stringify(curJsonObj.table.clild.thead.clild.tr.self.style),e+=l+" tbody tr td"+JSON.stringify(curJsonObj.table.clild.tbody.clild.tr.self.style),e+=l+" tfoot tr td"+JSON.stringify(curJsonObj.table.clild.tfoot.clild.tr.self.style),e+=l+" tbody tr:nth-child(odd) td"+JSON.stringify(curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.odd),e+=l+" tbody tr:nth-child(even) td"+JSON.stringify(curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.even),e+=l+" tbody tr td:hover"+JSON.stringify(curJsonObj.table.clild.tbody.clild.tr.self.pseudoClass.hover)),$("#skincss").html(e.replace(/"/g,"").replace(/,/g,";"))}