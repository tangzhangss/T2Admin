function createParmHtml(e){function f(e){var a="";return $.each(e,function(e,t){void 0!==t&&null!=t&&""!=t&&(a+=" on"+e+'="'+t+'" ')}),a}var v=[],k=[],w=[];$.each(e,function(e,t){if(1==t.custom){var a={top:t.y+"px",left:t.x+"px",width:t.width+"px",height:t.height+"px","line-height":t.height+"px"},n={width:t.widthL+"%"},i={width:t.widthR+"%"},l=" "+t.labelStyle,o=" "+t.fieldStyle,p=$('<div class="form-group"></div>'),s="",r="";""!=t.mustInput&&"0"!=t.mustInput&&(s=' mustinput="1"',r='<span style="color:red">*</span> ');l=$('<label class="form-label'+l+'"></label>');t.cname?(l.html(r+t.cname),l.attr("title",t.cname)):(l.html(r+t.key),l.attr("title",t.key)),0!=t.selRange&&1!=t.selRange||p.append(l),"dynamic"==t.ptype&&p.hide(),l.css(n),p.css(a);var c="";if("1"==t.readonly&&(c=' readonly="true"'),!t.showtype||"select"!=t.showtype&&"multiple"!=t.showtype)if(!t.showtype||"date"!=t.showtype&&"year"!=t.showtype&&"month"!=t.showtype&&"time"!=t.showtype&&"datetime"!=t.showtype)if("radio"==t.showtype){var d=encodeURIComponent(t.value),u=$('<span class="form-input"></span>');if(t.keylist=window[t.fieldSize],t.keylist&&1==t.keylist.indexOf(":")&&-1!=t.keylist.indexOf(","))for(var h,y=t.keylist.split(","),m=0;m<y.length;m++)u.append('<lable class="radio_text">'+y[m].split(":")[0]+"</lable>"),(h=$("<input"+c+s+' name="'+t.key+'" value="'+y[m].split(":")[1]+'" type="radio" class="radio_text'+o+'"'+f(t.event)+"/>")).find("input").css(i),u.append(h);u.css(i)}else"checkbox"==t.showtype?(d=encodeURIComponent(t.value),(h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+d+'" class="form-input'+o+'" type="text" '+f(t.event)+"/>")).css(i)):"render"==t.showtype?(d=encodeURIComponent(t.value),(h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+d+'" class="form-input'+o+'" type="text" '+f(t.event)+"/>")).css(i),p.append(h),w.push(t)):"radio-pop"==t.showtype?(g=$("<select"+s+' name="'+t.key+'" id="'+t.key+'" class="form-select'+o+'" '+f(t.event)+"></select>"),t.value&&-1!=t.value.indexOf(":")?popupSelection.createOption(g,t.value):(g.append("<option value=''></option>"),g.append("<option value='"+t.value+"'>"+t.value+"</option>")),g.css(i),p.append(g),popupSelection.checkInit(g,t.cname)):"checkbox-pop"==t.showtype?(g=$("<select"+s+' name="'+t.key+'" id="'+t.key+'" class="form-select'+o+'" '+f(t.event)+"></select>"),t.value&&-1!=t.value.indexOf(":")?popupSelection.createOption(g,t.value):(g.append("<option value=''></option>"),g.append("<option value='"+t.value+"'>"+t.value+"</option>")),g.css(i),p.append(g),popupSelection.checkInit(g,t.cname,!0)):"radio-pop-tree"==t.showtype?(d=encodeURIComponent(t.value),h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+d+'" class="form-input'+o+'" type="text" '+f(t.event)+"/>"),p.append(h),popupSelection.treeInit(h,t.cname,!1,t.fieldSize)):"checkbox-pop-tree"==t.showtype?(d=encodeURIComponent(t.value),h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+d+'" class="form-input'+o+'" type="text" '+f(t.event)+"/>"),p.append(h),popupSelection.treeInit(h,t.cname,!0,t.fieldSize)):(d=encodeURIComponent(t.value),(h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+d+'" class="form-input'+o+'" type="text" '+f(t.event)+"/>")).css(i),0!=t.selRange&&2!=t.selRange||p.append(h));else(h=$("<input"+c+s+' name="'+t.key+'" id="'+t.key+'" value="'+t.value+'" class="form-input'+o+'" autocomplete="off" type="text" '+f(t.event)+"/>")).css(i),0!=t.selRange&&2!=t.selRange||p.append(h),v.push(t);else{var g=$("<select"+s+' name="'+t.key+'" id="'+t.key+'" class="form-select'+o+'" '+f(t.event)+"></select>");t.keylist&&-1!=t.keylist.indexOf(":")?popupSelection.createOption(g,t.keylist):check.isNotNull(t.fieldSize)&&window[t.fieldSize]?(d="",d="function"==typeof window[t.fieldSize]?window[t.fieldSize].call(this):window[t.fieldSize],popupSelection.createOption(g,d)):(g.append("<option value=''></option>"),g.append("<option value='"+t.value+"'>"+t.value+"</option>")),g.css(i),0!=t.selRange&&2!=t.selRange||p.append(g),"multiple"==t.showtype&&(g.css("display","none"),k.push(t))}"hidden"!=$("#"+t.key).attr("type")&&p.appendTo($("#searchaddition"))}});for(var t=0;t<v.length;t++){var a=v[t].format||"yyyy-MM-dd";laydate.render({elem:"#"+v[t].key,format:a,type:v[t].showtype})}for(t=0;t<w.length;t++){var l=w[t],a=l.format||"yyyy-MM-dd";laydate.render({elem:"#"+l.key,range:!0,done:function(e,t,a){var n,i=$("#"+l.fieldStyle);0<i.length&&(n=e.split(" - "),setTimeout(function(){$("#"+l.key).val(n[0])},1),i.val(n[1]))}})}for(t=0;t<k.length;t++)$("#"+k[t].key).popupSelection({searchOn:!0,inline:!0,multiple:!0,title:k[t].cname,cellCount:4,labelShow:!0})}function initSearchParm(e){$.ajax({url:"../../rdppub/showparam",cache:!1,data:{uuid:e},type:"post",success:function(e){var t,a=e.data;a.searchParmJson.length<=0?$("#parmlist").hide():((t=a.queryArea)&&(t.css&&loadStyle(Base64Util.decode64(t.css)),t.js&&loadScript(Base64Util.decode64(t.js)),t.height&&($(".rt-parmlist").height(parseInt(t.height)+10),e=$("#toolbar").outerHeight(!0),t=targetRealHeight(".rt-parmlist"),getSubHeight(),$(".rt-parmlist").hasClass("on")?$("#datalist").css({height:"calc(100% - "+(e+targetOutHeight("#datalist")+scrollBarHeight+t)+"px)"}):$("#datalist").css({height:"calc(100% - "+(e+targetOutHeight("#datalist")+scrollBarHeight)+"px)"}))),createParmHtml(a.searchParmJson),$("#searchaddition").append('<input type="button" onclick="search()" value="查询" id="searchlist" />')),1==autoSub&&search()}})}function search(){var e="";$("#searchaddition select").each(function(){null!=$(this).attr("mustinput")&&"1"==$(this).attr("mustinput")&&""==$(this).val()&&(e+=$(this).parent().find("label").text().replace("* ",""))}),$("#searchaddition input").each(function(){null!=$(this).attr("mustinput")&&"1"==$(this).attr("mustinput")&&("text"==$(this).attr("type")&&""==$(this).val()&&(e+=$(this).parent().find("label").text().replace("* ","")+"、"),"hidden"==$(this).attr("type")&&""==$(this).val()&&(e+=$(this).parent().find("label").text().replace("* ","")+"、"),"radio"!=$(this).attr("type")&&"checkbox"!=$(this).attr("type")||0!=$('input[name="'+$(this).attr("name")+'"]:checked').length||(e+=$(this).parent().find("label").text().replace("* ","")+"、"))}),0<e.length?alert("缺少必填项："+e.substring(0,e.length-1)):init(1)}var setting={data:{simpleData:{enable:!0}}},check={isNotNull:function(e){return void 0!==e&&null!=e&&""!=e}},popupSelection={checkInit:function(e,t,a){$(e).popupSelection({searchOn:!0,inline:!1,multiple:a,title:"选择"+t,changeCallback:function(e){},cellCount:4,labelShow:!0})},treeInit:function(e,t,a,n){$(e).popupSelection({searchOn:!0,multiple:a,title:t,items:popupSelection.getItems(n),ztree:!0,changeCallback:function(e){},ztreeSetting:setting})},getItems:function(e){var t=[];return void 0!==window[e]?t=window[e]:$.ajax({url:"../../rdpparm/parm/"+e,cache:!1,async:!1,type:"post",success:function(e){t=e.data}}),t},createOption:function(e,t){if(-1!=t.indexOf(",")){var a=t.split(",");e.append("<option value=''></option>");for(var n=0;n<a.length;n++)e.append("<option value='"+a[n].split(":")[1]+"'>"+a[n].split(":")[0]+"</option>")}else e.append("<option value='"+keylist.split(":")[1]+"'>"+keylist.split(":")[0]+"</option>")}};function loadScript(e,t){var a=document.createElement("script");a.type="text/javascript",void 0!==e&&(a.readyState?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,t())}:a.onload=function(){t()}),a.appendChild(document.createTextNode("\n"+e+"\n")),document.head.appendChild(a)}function loadStyle(e){var t=document.createElement("style");t.setAttribute("type","text/css"),t.styleSheet?t.styleSheet.cssText=e:(a=document.createTextNode("\n"+e+"\n"),t.appendChild(a));var a=document.getElementsByTagName("head");(a.length?a[0]:doc.documentElement).appendChild(t)}var scrollBarHeight=20,scrollBarWidth=16,getTargetPropertyVal=function(e,t){try{if($(e).css(t))return parseFloat($(e).css(t).replace("px",""))}catch(e){}return 0},getSubHeight=function(e,t){var a=0;return e=e||scrollBarHeight,t||(a+=$(".rt-parmlist").outerHeight(!0)),a+=$("#toolbar").outerHeight(!0),a+=getTargetPropertyVal("#datalist","marginTop"),a+=getTargetPropertyVal("#datalist","marginBottom"),a+=getTargetPropertyVal("#datalist","paddingTop"),(a+=getTargetPropertyVal("#datalist","paddingBottom"))+e},targetRealHeight=function(e){return $(e).height()+getTargetPropertyVal(e,"paddingTop")+getTargetPropertyVal(e,"paddingBottom")},targetOutHeight=function(e){return getTargetPropertyVal(e,"marginTop")+getTargetPropertyVal(e,"marginBottom")+getTargetPropertyVal(e,"paddingTop")+getTargetPropertyVal(e,"paddingBottom")};function initParamsBar(){$(".rt-swicth").bind("click",function(){function e(e,t,a){a=a||750,$(e).css({transition:"all "+a/1e3+"s"}),$(e).css(t),setTimeout(function(){$(e).css({transition:""})},a)}var t=$("#toolbar").outerHeight(!0),a=targetRealHeight(".rt-parmlist");getSubHeight();$(".rt-parmlist").hasClass("on")?($(".rt-parmlist").removeClass("on").css("margin-top",-$(".rt-parmlist").outerHeight(!0)+"px"),e("#datalist",{height:"calc(100% - "+(t+targetOutHeight("#datalist")+scrollBarHeight)+"px)"})):($(".rt-parmlist").addClass("on").css("margin-top",0),e("#datalist",{height:"calc(100% - "+(t+targetOutHeight("#datalist")+scrollBarHeight+a)+"px)"}))})}var flag=!0;function getQueryString(e){e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),e=window.location.search.substr(1).match(e);return null!=e?unescape(e[2]):null}$(function(){initSearchParm(uuid),initParamsBar(),$("body").css("overflow","auto")});